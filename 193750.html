<!DOCTYPE html>
<html>

<head>
    <title>M3-TRADER</title>
    <link id="favicon" rel="icon" href="./favicon.ico" type="image/png" sizes="16x16">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <link rel="stylesheet" href="./style.css">
    <link rel="apple-touch-icon" sizes="128x128" href="./favicon-2.png">
    <link rel="manifest" href="./manifest.json">
    <script src="https://www.w3schools.com/lib/w3.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="./helper-functions.js"></script>
    <script src="./scores.js"></script>
    <script src="./config.js"></script>
    <script src="./HackTimer.js"></script>
    <script src="./colors.js"></script>
    <script src="./calendar.js"></script>
    <script src="./bollinger-bands.js"></script>
    <script src="./buy-sell-positions.js"></script>
    <script src="./calculate-trendline.js"></script>
    <script src="./chart-bar-options.js"></script>
    <script src="./chart-area-spline-options.js"></script>
    <script src="./alpaca.js"></script>
    <script src="./stock_symbols_detail.js"></script>
</head>
<style>
</style>

<body class="" style="_font-family:Raleway;">

    <div class="_w3-container"
        style="padding: 8px 8px 0px 8px;position: sticky;top: 0;z-index: 9999;background-color:black;">
        <h2 style="background-color:#00b90a;"><img src="./favicon-black.png"
                style="padding-bottom:16px;width:110px;margin-right:23px;margin-left:10px;margin-top:15px;" /><span
                class="w3-text-black w3-xxlarge"><b>M<sup>3</sup> TRADER</b> | </span>
            <span class="_w3-tiny w3-text-black">
                <span id="datetime" class="w3-xxlarge"></span>
            </span>
            <!-- <br /> -->
            <!-- <b><span id="" class="w3-text-black" style="font-size:64px;">$1,234 | 12.36%</span></b> -->
            <span class="w3-container _w3-xxxlarge w3-right w3-text-black"
                style="font-size:40px;margin-right: 5px;cursor:pointer;margin-top:20px;"
                onclick="window.location=window.location"><b><i class="fa fa-refresh" aria-hidden="true"></i></b>
            </span>
            <!-- <br/> -->
            <div class="w3-medium w3-right w3-padding" style="margin-top:10px;">
                <!-- <input id="dateSelector" class="date w3-hide _-small w3-hide-medium" type="date"
                    onchange="clickDate(this.value)"></input> -->
                <!-- <br /> -->
                <!-- <span id="datetime" class="w3-xlarge"></span>
                <span class="w3-xlarge" style="margin-left: 5px;cursor:pointer;"
                    onclick="window.location=window.location">&#x27F3;
                </span> -->
            </div>
        </h2>
        <h2 class="w3-hide-small" style="background-color:black;">
            <div class="w3-container w3-text-black" style="color:black;_background-color:#000000;">
                <h3 class="w3-xxxlarge"><b id="total-positions-banner">&nbsp;</b>
                    <span class="w3-right">
                        <!-- <i class="fa fa-toggle-on" style="cursor:pointer;" onclick="toggleAutoReset(this)"></i>
                    <span class="w3-medium"
                        style="padding-right: 5px;top: -7px;display: inline;position: relative;">Auto Refresh </span> -->

                        <!-- <i id="toggle-crypto" class="fa fa-toggle-on" style="cursor:pointer;"
                        onclick="toggleCryptoStocks(this)"></i>
                    <span class="w3-medium"
                        style="padding-right: 5px;top: -7px;display: inline;position: relative;">Crypto </span> -->

                        <i id="open-settings" class="fa fa-gear w3-text-grey" style="cursor:pointer;padding-top:25px;"
                            onclick="open_settings()"></i>
                        <!-- <span class="w3-medium"
                        style="padding-right: 5px;top: -7px;display: inline;position: relative;">Settings </span> -->
                    </span>
                </h3>
            </div>

            <!-- <div id="current_conditions" class="w3-medium"></div> -->
        </h2>
    </div>

    <div id="tabs" class="w3-bar w3-black" style="display:none;">
    </div>

    <div id="content-ytd" class="_w3-margin" style="_display:none;">
        <!-- <div class="w3-container w3-text-black" style="background-color:#00b90a;">
            <h3 class="w3-xxxlarge"><b id="total-positions-banner">&nbsp;</b></h3>
        </div> -->

        <div class="_w3-content">

            <div class="w3-row w3-margin w3-black" style="border-bottom: 1px solid white;">

                <div class="_w3-twothird _w3-third w3-padding w3-center w3-large">
                    <span id="open-postions-banner-title">OPEN POSITIONS</span>
                    <div id="chart-positions"></div>
                </div>
                <!-- <div class="w3-twothird w3-container">
                    <h2>
                    </h2>
                </div> -->

            </div>
            <div class="w3-row w3-margin w3-black" style="display:none;border-bottom: 1px solid white;">

                <div class="w3-third w3-padding">
                    <!-- <div id="chart-symbols-group-1"></div> -->
                </div>
                <div class="w3-twothird w3-container">
                    <h2>
                        <!-- <div class="w3-padding w3-col s12 m4 l3 w3-center"
                            style="_display:none;border:1px solid rgb(92, 92, 92);_min-height:457px;"> -->
                        <div id="title-symbols-group-1"></div>
                        <!-- <div id="chart-symbols-group-1-tree"></div> -->
                        <!-- </div> -->
                    </h2>
                    <!-- <div id="chart-symbols-breakdown-1"></div> -->
                    <!-- <p>
                        
                    </p> -->
                </div>

            </div>
            <div class="w3-row w3-margin w3-black" style="display:none;border-bottom: 1px solid white;">

                <div class="w3-third w3-padding" _class="w3-col s12 m5 w3-padding">
                    <!-- <div id="chart-symbols-group-2"></div> -->
                </div>
                <div class="w3-twothird w3-container" _class="w3-col s12 m7 w3-container">
                    <h2>
                        <div id="title-symbols-group-2"></div>
                        <!-- <div id="chart-symbols-group-2-tree"></div> -->
                    </h2>
                    <!-- <br /> -->
                    <!-- <button id="buy_symbol" class="w3-button _w3-right w3-round-large w3-large w3-padding w3-half"
                        style="background-color:#121212;border:1px solid;" onclick="liquidate()">Liquidate</button>
                    <button id="sell_symbol" class="w3-button w3-right w3-round-large w3-large w3-padding w3-half"
                        style="background-color:#121212;border:1px solid;"
                        onclick="buy_symbols(symbol_groups.STOCKS.symbols, +(document.getElementById('slider-value').innerHTML.replace('$','').replace('K','') * 1000))">BUY
                        ALL</button> -->

                    <!-- <p>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut
                        labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
                        laboris nisi ut aliquip ex ea commodo consequat.
                    </p> -->
                </div>

            </div>
            <div class="w3-row w3-margin w3-black" style="display:none;border-bottom: 1px solid white;">

                <div class="w3-third w3-padding">
                    <!-- <img src="./favicon-white.png" style="width:100%;min-height:200px"> -->
                    <!-- <div id="chart-symbols-group-3"></div> -->
                </div>
                <div class="w3-twothird w3-container">
                    <h2>
                        <!-- <div class="w3-padding w3-col s12 m4 l3 w3-center"
                            style="_display:none;border:1px solid rgb(92, 92, 92);_min-height:457px;"> -->
                        <div id="title-symbols-group-3"></div>
                        <!-- <div id="chart-symbols-group-3-tree"></div> -->
                        <!-- </div> -->
                    </h2>
                    <!-- <p>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut
                        labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
                        laboris nisi ut aliquip ex ea commodo consequat.
                    </p> -->
                </div>

            </div>
            <div class="w3-row w3-margin w3-black" style="display:none;border-bottom: 1px solid white;">

                <div class="w3-third w3-padding">
                    <!-- <img src="./favicon-white.png" style="width:100%;min-height:200px"> -->
                    <!-- <div id="chart-symbols-group-3"></div> -->
                </div>
                <div class="w3-twothird w3-container">
                    <h2>
                        <!-- <div class="w3-padding w3-col s12 m4 l3 w3-center"
                            style="_display:none;border:1px solid rgb(92, 92, 92);_min-height:457px;"> -->
                        <div id="title-symbols-group-4"></div>
                        <!-- <div id="chart-symbols-group-3-tree"></div> -->
                        <!-- </div> -->
                    </h2>
                    <!-- <p>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut
                        labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
                        laboris nisi ut aliquip ex ea commodo consequat.
                    </p> -->
                </div>

            </div>
            <!-- <div class="w3-row w3-margin w3-black" style="_display:none;border-bottom: 1px solid white;">

                <div class="w3-third w3-padding">
                    <div id="chart-symbols-group-4"></div>
                </div>
                <div class="w3-twothird w3-container">
                    <h2>
                        <div id="title-symbols-group-4"></div>
                        <div id="chart-symbols-group-4-tree"></div>
                    </h2>
                </div>

            </div> -->


            <!-- <div class="w3-row-padding" style="display: none;">

                <div class="w3-third w3-margin-bottom">
                    <ul class="w3-ul w3-border w3-center w3-hover-shadow">
                        <li class="w3-black w3-xlarge w3-padding-32">STOCKS</li>
                        <li class="w3-padding-16"><b>10GB</b> Storage</li>
                        <li class="w3-padding-16"><b>10</b> Emails</li>
                        <li class="w3-padding-16"><b>10</b> Domains</li>
                        <li class="w3-padding-16"><b>Endless</b> Support</li>
                        <li class="w3-padding-16">
                            <h2 class="w3-wide">$ 1.5K</h2>
                            <span class="w3-opacity">per month</span>
                        </li>
                        <li class="_w3-light-grey w3-padding-24">
                            <button class="w3-button w3-text-black w3-padding-large"
                                style="background-color:#00b90a;">Sign Up</button>
                        </li>
                    </ul>
                </div>

                <div class="w3-third w3-margin-bottom">

                    <ul class="w3-ul w3-border w3-center w3-hover-shadow">
                        <li class="w3-text-black w3-xlarge w3-padding-32" style="background-color:#00b90a;">R&D</li>
                        <li class="w3-padding-16"><b>25GB</b> Storage</li>
                        <li class="w3-padding-16"><b>25</b> Emails</li>
                        <li class="w3-padding-16"><b>25</b> Domains</li>
                        <li class="w3-padding-16"><b>Endless</b> Support</li>
                        <li class="w3-padding-16">
                            <h2 class="w3-wide">$ 1K</h2>
                            <span class="w3-opacity">per month</span>
                        </li>
                        <li class="_w3-light-grey w3-padding-24">
                            <button class="w3-button w3-text-black w3-padding-large"
                                style="background-color:#00b90a;">Sign Up</button>
                        </li>
                    </ul>
                </div>

                <div class="w3-third w3-margin-bottom">
                    <ul class="w3-ul w3-border w3-center w3-hover-shadow">
                        <li class="w3-black w3-xlarge w3-padding-32">CRYPTO</li>
                        <li class="w3-padding-16"><b>50GB</b> Storage</li>
                        <li class="w3-padding-16"><b>50</b> Emails</li>
                        <li class="w3-padding-16"><b>50</b> Domains</li>
                        <li class="w3-padding-16"><b>Endless</b> Support</li>
                        <li class="w3-padding-16">
                            <h2 class="w3-wide">$ 50</h2>
                            <span class="w3-opacity">per month</span>
                        </li>
                        <li class="_w3-light-grey w3-padding-24">
                            <button class="w3-button w3-text-black w3-padding-large"
                                style="background-color:#00b90a;">Sign Up</button>
                        </li>
                    </ul>
                </div>
            </div> -->

            <!-- <div class="w3-row w3-margin">

                <div class="w3-third">
                    <img src="img_monterosso.jpg" style="width:100%;min-height:200px">
                </div>
                <div class="w3-twothird w3-container">
                    <h2>Monterosso</h2>
                    <p>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut
                        labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
                        laboris nisi ut aliquip ex ea commodo consequat.
                    </p>
                </div>

            </div>
            <div class="w3-row w3-margin">

                <div class="w3-third">
                    <img src="img_vernazza.jpg" style="width:100%;min-height:200px">
                </div>
                <div class="w3-twothird w3-container">
                    <h2>Vernazza</h2>
                    <p>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut
                        labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
                        laboris nisi ut aliquip ex ea commodo consequat.
                    </p>
                </div>

            </div>
            <div class="w3-row w3-margin">

                <div class="w3-third">
                    <img src="img_manarola.jpg" style="width:100%;min-height:200px">
                </div>
                <div class="w3-twothird w3-container">
                    <h2>Manarola</h2>
                    <p>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut
                        labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
                        laboris nisi ut aliquip ex ea commodo consequat.
                    </p>
                </div>

            </div>
            <div class="w3-row w3-margin">

                <div class="w3-third">
                    <img src="img_corniglia.jpg" style="width:100%;min-height:200px">
                </div>
                <div class="w3-twothird w3-container">
                    <h2>Corniglia</h2>
                    <p>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut
                        labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
                        laboris nisi ut aliquip ex ea commodo consequat.
                    </p>
                </div>

            </div>
            <div class="w3-row w3-margin">

                <div class="w3-third">
                    <img src="img_riomaggiore.jpg" style="width:100%;min-height:200px">
                </div>
                <div class="w3-twothird w3-container">
                    <h2>Riomaggiore</h2>
                    <p>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut
                        labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
                        laboris nisi ut aliquip ex ea commodo consequat.
                    </p>
                </div>

            </div> -->
        </div>
    </div>

    <div id="content-weeks" class="w3-margin" style="display:none;">
        Weeks
    </div>

    <div id="content-day" class="w3-margin w3-center" style="display:none;">
    </div>

    <div id="content-account" class="" style="display:none;">
    </div>

    <p class="w3-center w3-xlarge" style="display: flex;justify-content: center;flex-wrap: wrap;">
        <label style="margin-right:30px;display:inline-flex;"><input class="w3-radio" type="radio" name="gender"
                value="favs" onclick="toggle_groups(this.value)">&nbsp;<span id="radio-group-1"></span></label>
        <label style="margin-right:30px;display:inline-flex;"><input class="w3-radio" type="radio" name="gender"
                value="stocks" onclick="toggle_groups(this.value)">&nbsp;<span id="radio-group-2"></span></label>
        <label style="margin-right:30px;display:inline-flex;"><input class="w3-radio" type="radio" name="gender"
                value="rd" onclick="toggle_groups(this.value)">&nbsp;<span id="radio-group-3"></span></label>
        <!-- <label style="margin-right:30px;display:inline-flex;"><input class="w3-radio" type="radio" name="gender"
                    value="crypto" onclick="toggle_groups(this.value)">&nbsp;<span id="radio-group-4"></span></label> -->
        <label style="margin-right:30px;display:inline-flex;"><input class="w3-radio" type="radio" name="gender"
                value="account" onclick="toggle_groups(this.value)">&nbsp;ACCOUNT</label>
        <label style="margin-right:30px;display:inline-flex;"><input class="w3-radio" type="radio" name="gender"
                value="table" onclick="toggle_groups(this.value)">&nbsp;TABLE</label>
        <label style="margin-right:30px;display:inline-flex;"><input class="w3-radio" type="radio" name="gender"
                value="info" onclick="toggle_groups(this.value)" checked>&nbsp;INFO</label>
        <label style="margin-right:30px;display:inline-flex;"><input class="w3-radio" type="radio" name="gender"
                value="symbols" onclick="toggle_groups(this.value)">&nbsp;SYMBOLS</label>
    </p>

    <!-- Bollinger -->
    <div id="content-bollinger" class="_w3-margin" style="display:none;">
        <!-- <br /> -->
        <div id="chart-bars" class="w3-row" style="_display:none;_border:1px solid; _min-height:600px;">
            <div class="w3-col s12 m6 l3 w3-padding" style="display:none;border:1px solid rgb(92, 92, 92);">
                <div id="total-positions-2" class="w3-center w3-xxlarge"
                    style="_min-height: 390.5px;align-content: center;font-weight:900;font-size:6.0vh !important;flex:inline-grid;">
                </div>
            </div>
            <div class="w3-col s12 m6 l6 chart-symbol-day-3 w3-padding"
                style="display:none;border:1px solid rgb(92, 92, 92);_min-height:407px;;">
                <div _id="" style="font-size: 18px; color: rgb(255, 255, 255);">OPEN POSITIONS</div>
                <div id="chart-positions"></div>
            </div>
            <div class="w3-padding w3-col s12 m6 l3"
                style="display:none;border:1px solid rgb(92, 92, 92);_min-height:457px;">
                <div id="title-symbols-stacked-6"></div>
                <div id="chart-symbols-stacked-6"></div>
            </div>
            <!-- --------------------------------------------------------- -->
            <!-- <div class="w3-padding w3-col s12 m4 l3 w3-center"
                style="display:none;border:1px solid rgb(92, 92, 92);_min-height:457px;">
                <div id="title-symbols-group-1"></div>
                <div id="chart-symbols-group-1"></div>
            </div> -->
            <!-- <div class="w3-padding w3-col s12 m4 l3 w3-center"
                style="_display:none;border:1px solid rgb(92, 92, 92);_min-height:457px;">
                <div id="title-symbols-group-2"></div>
                <div id="chart-symbols-group-2"></div>
            </div> -->
            <!-- <div class="w3-padding w3-col s12 m4 l3 w3-center"
                style="_display:none;border:1px solid rgb(92, 92, 92);_min-height:457px;">
                <div id="title-symbols-group-3"></div>
                <div id="chart-symbols-group-3"></div>
            </div> -->
            <!-- <div class="w3-padding w3-col s12 m4 l3 w3-center"
                style="display:none;border:1px solid rgb(92, 92, 92);_min-height:457px;">
                <div id="title-symbols-group-4"></div>
                <div id="chart-symbols-group-4"></div>
            </div> -->
            <!-- --------------------------------------------------------- -->

            <br />
            <!-- <div class="w3-col s9 l2 w3-padding w3-hide-small w3-hide-medium"
                style="border:1px solid rgb(92, 92, 92);_min-height:300px;;">
                <div id="chart-bollinger-1"></div>
            </div> -->

            <div class="w3-col s12 m8 l9 w3-padding _w3-hide-small _w3-hide-medium"
                style="border:1px solid rgb(92, 92, 92); _min-height:500px;;">
                <div id="chart-bollinger-0"></div>
            </div>
            <div class="w3-col s12 m4 l3 w3-padding" style="border:1px solid rgb(92, 92, 92);_min-height:500px;">
                <div id="chart-bollinger-2"></div>
                <!-- <input class="w3-col s6" type="number" value="1000"/> -->
                <input type="range" min="0" max="5" value="0.25" step="0.25" style="accent-color:#00b90a;width:80%;"
                    oninput="document.getElementById('slider-value').innerHTML = `$${this.value}K`">
                <span id="slider-value">$1K</span>
                <br />
                <button id="buy_symbol" class="w3-button _w3-right w3-round-large w3-large w3-padding w3-half"
                    style="background-color:#121212;border:1px solid;"
                    onclick="sell(bollinger_selected_symbol)">Sell</button>
                <button id="sell_symbol" class="w3-button _w3-right w3-round-large w3-large w3-padding w3-half"
                    style="background-color:#121212;border:1px solid;"
                    onclick="buy(bollinger_selected_symbol, +(document.getElementById('slider-value').innerHTML.replace('$','').replace('K','') * 1000))">Buy</button>
            </div>
        </div>
        <!-- <br /> -->
        <!-- <div id="chart-symbols-treemap"></div> -->
        <div id="symbol-buttons-bollinger-stocks" class="_w3-col s12 w3-margin w3-padding w3-center"
            style="width:100%;display: flex;flex-direction: row;flex-wrap: wrap;justify-content:center;overflow-y:scroll;max-height:400px;scrollbar-color: #000000 #373737;">
        </div>
        <div id="symbol-buttons-bollinger-favs" class="_w3-col s12 w3-padding w3-center"
            style="width:100%;display: flex;flex-direction: row;flex-wrap: wrap;justify-content:center;overflow-y:scroll;max-height:400px;scrollbar-color: #000000 #373737;">
        </div>
        <div id="symbol-buttons-bollinger-rd" class="_w3-col s12 w3-padding w3-center"
            style="width:100%;display: flex;flex-direction: row;flex-wrap: wrap;justify-content:center;overflow-y:scroll;max-height:400px;scrollbar-color: #000000 #373737;">
        </div>
        <div id="symbol-buttons-bollinger-crypto" class="_w3-col s12 w3-padding w3-center"
            style="width:100%;display: flex;flex-direction: row;flex-wrap: wrap;justify-content:center;overflow-y:scroll;max-height:400px;scrollbar-color: #000000 #373737;">
        </div>
        <div id="symbol-buttons-bollinger-table" class="_w3-col s12 w3-padding w3-center"
            style="width:100%;display: flex;flex-direction: row;flex-wrap: wrap;justify-content:center;"><br />
            <table class="w3-table-all w3-xlarge">
                <thead>
                    <tr style="background-color: black !important;">
                        <th>Symbol</th>
                        <th>Position</th>
                        <th>YTD</th>
                        <th style="width:33%">CHART</th>
                    </tr>
                </thead>
                <tbody id="symbol-table">
                    <tr>
                        <td>Jill</td>
                        <td>Smith</td>
                        <td>50</td>
                        <td>50</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div id="symbol-buttons-bollinger-account" class="_w3-col s12 w3-padding w3-center w3-xlarge w3-black"
            style="width:100%;display: flex;flex-direction: row;flex-wrap: wrap;justify-content:center;">
            Account Transactions
            <table class="w3-table-all">
                <thead>
                    <tr style="background-color: black !important;">
                        <th>Date</th>
                        <th>Gain</th>
                        <th>Pct</th>
                        <th>Spend</th>
                    </tr>
                </thead>
                <tbody id="order-transactions">
                    <tr>
                        <td>Jill</td>
                        <td>Smith</td>
                        <td>50</td>
                        <td>50</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div id="symbol-buttons-bollinger-symbols" class="_w3-col s12 w3-padding w3-center"
            style="width:100%;display: flex;flex-direction: row;flex-wrap: wrap;justify-content:center;overflow-y:scroll;max-height:400px;scrollbar-color: #000000 #373737;">
            <div id="symbols_for_letter"></div>
            <div id="letters"></div>
        </div>
        <!--# INFO PANELS  -->
        <div id="symbol-buttons-bollinger-info" class="_w3-col s12 w3-padding w3-center"
            style="width:100%;display: flex;flex-direction: row;flex-wrap: wrap;justify-content:center;">
            <div class="_w3-row-padding" style="_display: none;_font-family: monospace;">
                <div class="w3-third w3-margin-bottom">
                    <ul class="w3-ul w3-border w3-center w3-hover-shadow">
                        <li id="group-name-1" class="w3-black w3-xlarge w3-padding-32">STOCKS</li>
                        <li class="w3-padding-16">
                            <div id="chart-symbols-group-1"></div>
                        </li>
                        <li class="w3-padding-16">
                            <div id="chart-symbols-group-1-tree"></div>
                        </li>
                        <li class="w3-padding-16">APY<br /><b id="group-total-1" class="w3-xxlarge"
                                style="color:#00b90a;">-K</b><br /><b id="group-total-detail-1" class="w3-large"
                                style="color:#00b90a;">$- | -% @ -K</b></li>
                        <li class="w3-padding-16">Current Trades<br /><b id="group-current-trades-1" class="w3-xxlarge"
                                style="color:#00b90a;">$-</b></li>
                        <li class="w3-padding-16">Current Positions<br /><b id="group-current-positions-1"
                                class="w3-xxlarge" style="color:#00b90a;">$-</b></li>
                        <!-- <li class="w3-padding-16"><b id="group-current-positions-1" class="w3-large"
                                style="color:#00b90a;">
                                <div style="display:flex;flex-wrap:wrap;justify-content: space-between;">
                                    <div>&#9650;&nbsp;RKLB&nbsp;$-80</div>
                                    <div style="color:red;">&#9660;&nbsp;RKLB&nbsp;$-80</div>
                                    <div>&#9650;&nbsp;RKLB&nbsp;$-80</div>
                                    <div>&#9650;&nbsp;XERS&nbsp;$64</div>
                                </div>
                            </b>
                        </li> -->
                    </ul>
                </div>
                <div class="w3-third w3-margin-bottom">
                    <ul class="w3-ul w3-border w3-center w3-hover-shadow">
                        <li id="group-name-2" class="w3-black w3-xlarge w3-padding-32">STOCKS</li>
                        <li class="w3-padding-16">
                            <div id="chart-symbols-group-2"></div>
                        </li>
                        <li class="w3-padding-16">
                            <div id="chart-symbols-group-2-tree"></div>
                        </li>
                        <li class="w3-padding-16">APY<br /><b id="group-total-2" class="w3-xxlarge"
                                style="color:#00b90a;">$-K</b><br /><b id="group-total-detail-2" class="w3-large"
                                style="color:#00b90a;">$- | -% @ -K</b></li>
                        <li class="w3-padding-16">Current Trades<br /><b id="group-current-trades-2" class="w3-xxlarge"
                                style="color:#00b90a;">$-</b></li>
                        <li class="w3-padding-16">Current Positions<br /><b id="group-current-positions-2"
                                class="w3-xxlarge" style="color:#00b90a;">$-</b></li>
                    </ul>
                </div>
                <div class="w3-third w3-margin-bottom">
                    <ul class="w3-ul w3-border w3-center w3-hover-shadow">
                        <li id="group-name-3" class="w3-black w3-xlarge w3-padding-32">STOCKS</li>
                        <li class="w3-padding-16">
                            <div id="chart-symbols-group-3"></div>
                        </li>
                        <li class="w3-padding-16">
                            <div id="chart-symbols-group-3-tree"></div>
                        </li>
                        <li class="w3-padding-16">APY<br /><b id="group-total-3" class="w3-xxlarge"
                                style="color:#00b90a;">$-K</b><br /><b id="group-total-detail-3" class="w3-large"
                                style="color:#00b90a;">$- | -% @ -K</b></li>
                        <li class="w3-padding-16">Current Trades<br /><b id="group-current-trades-3" class="w3-xxlarge"
                                style="color:#00b90a;">$-</b></li>
                        <li class="w3-padding-16">Current Positions<br /><b id="group-current-positions-3"
                                class="w3-xxlarge" style="color:#00b90a;">$-</b></li>
                    </ul>
                </div>
                <!-- &nbsp;<br /> -->

                <div class="w3-third w3-margin-bottom" style="display:none;">
                    <ul class="w3-ul w3-border w3-center w3-hover-shadow">
                        <li id="group-name-4" class="w3-black w3-xlarge w3-padding-32">STOCKS</li>
                        <li class="w3-padding-16">
                            <div id="chart-symbols-group-4"></div>
                        </li>
                        <li class="w3-padding-16">
                            <div id="chart-symbols-group-4-tree"></div>
                        </li>
                        <li class="w3-padding-16">APY<br /><b id="group-total-4" class="w3-xxlarge"
                                style="color:#00b90a;">$-K</b><br /><b id="group-total-detail-4" class="w3-large"
                                style="color:#00b90a;">$- | -% @ -K</b></li>
                        <li class="w3-padding-16">Current Trades<br /><b id="group-current-trades-4" class="w3-xxlarge"
                                style="color:#00b90a;">$-</b></li>
                        <li class="w3-padding-16">Current Positions<br /><b id="group-current-positions-4"
                                class="w3-xxlarge" style="color:#00b90a;">$-</b></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <p id="output"></p>

    <!-- MODAL ACCOUNT DIALOG -->
    <div class="w3-col s12">
        <div id="modal-configuration" class="w3-modal w3-xxlarge"
            style="z-index:99999;_display:block;background-color:#000;">
            <div class="w3-modal-content" style="_margin-left: 5%;">
                <form class="w3-container w3-padding w3-xlarge"
                    style="background-color: #000;color:white;_border:1px solid;padding-bottom:20px;">


                    <!-- <br />
                    <br /> -->
                    <div class="_w3-container w3-center">
                        <img src="./favicon.ico" style="width:300px;" />
                    </div>

                    <span onclick="document.getElementById('modal-configuration').style.display='none'"
                        class="w3-button w3-xxlarge w3-right">&times;</span>
                    <!-- <img src="./m3-logo-2-neon-green.png" style="width:90%;left:5%;" /> -->
                    <div>M<sup>3</sup> TRADER - Configuration</div>
                    <hr />
                    <label>Key</label>
                    <input id="input-key" class="w3-input" type="text" style="color:white;background-color:#555454;">
                    <br />
                    <label>Secret</label>
                    <input id="input-secret" class="w3-input" type="text" style="color:white;background-color:#555454;">
                    <br />

                    <label>Token</label>
                    <input id="input-token" class="w3-input" type="text" style="color:white;background-color:#555454;">
                    <p>
                        <input id="input-trade" class="w3-radio" type="radio" name="trade" value="true">
                        <label>Trade</label>
                        <input id="input-view" class="w3-radio" style="margin-left:20px;" type="radio" name="trade"
                            value="false" checked>
                        <label>View</label>
                    </p>

                    <button id="" class="w3-button w3-right w3-round-large w3-xxlarge w3-padding w3-margin"
                        style="background-color:#121212;border:1px solid;" onclick="setConfiguration()">Apply</button>
                </form>
            </div>
        </div>
    </div>
</body>

<script>
    /* PRINT THE VERSION */
    console.log(`%c------------------------------------------------------------------------------------------`, 'color:lime');
    console.log(`%c  ███      ███  ████\n  ██ ██  ██ ██    ██\n  ██   ██   ██  ████\n  ██        ██    ██\n  ██        ██  ████`, 'color:lime');
    console.log('%c   M3 TRADER v5.0.0', 'color:lime');
    console.log(`%c------------------------------------------------------------------------------------------`, 'color:lime');

    /* SET THE ALGORITHM CONFIGURATION */
    CONFIG.algo = CONFIG[CONFIG.algo_name];
    console.log('CONFIG', CONFIG);
</script>

<script>
    function isMobile() {
        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
            window.matchMedia("(max-width: 767px)").matches ||
            'ontouchstart' in window;
    }
    const mobile_view = isMobile();
    console.log('isMobile:', mobile_view);

    function isTablet() {
        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
            window.matchMedia("(max-width: 970px)").matches ||
            'ontouchstart' in window;
    }
    const tablet_view = isTablet();
    console.log('isTablet:', tablet_view);

    if (!isMobile()) {
        // document.getElementById('settings-panel').style.maxWidth = '500px';
        // document.getElementById('settings-panel').style.right = '0px';
    }
</script>

<script>
    function setConfiguration() {
        const key = document.getElementById('input-key').value;
        const secret = document.getElementById('input-secret').value;
        // const key_stocks = document.getElementById('input-key-stocks').value;
        // const secret_stocks = document.getElementById('input-secret-stocks').value;
        const token = document.getElementById('input-token').value;
        const trade = document.getElementById('input-trade').checked;
        const view = document.getElementById('input-view').checked;
        localStorage.setItem('m3-trader-v5-key', key);
        localStorage.setItem('m3-trader-v5-secret', secret);
        localStorage.setItem('m3-trader-v5-trade', trade);
        localStorage.setItem('m3-trader-v5-token', token);
        localStorage.setItem('m3-trader-v5-activeTab', 'bollinger');
        // alert(key, secret);

        window.location = window.location;
    }
    function open_settings() {
        document.getElementById('input-key').value = KEY;
        document.getElementById('input-secret').value = SECRET;
        document.getElementById('input-token').value = TOKEN;
        document.getElementById('input-trade').checked = trade;
        document.getElementById('input-view').checked = !trade;
        document.getElementById('modal-configuration').style.display = 'block';
    }
</script>

<script>
</script>

<script>
    let key = localStorage.getItem('m3-trader-v5-key');
    let secret = localStorage.getItem('m3-trader-v5-secret');
    // let key_stocks = localStorage.getItem('m3-trader-v5-key-stocks');
    // let secret_stocks = localStorage.getItem('m3-trader-v5-secret-stocks');
    let token = localStorage.getItem('m3-trader-v5-token');
    let trade = localStorage.getItem('m3-trader-v5-trade') === 'true' ? true : false;
    console.log(key, secret);
    if (key && key !== null && secret && secret !== null) {
        // console.log('API:', key, secret);
    } else {
        console.warn('API Key NOT found');
        document.getElementById('modal-configuration').style.display = 'block';
    }
</script>

<script>
    "use strict";

    const KEY = key;
    const SECRET = secret;
    // const KEY_STOCKS = key_stocks;
    // const SECRET_STOCKS = secret_stocks;
    const TRADE = trade;
    const TOKEN = token;
    const START_OF_YEAR = '2024-12-29';
    const HISTORIC_KEY_POSTFIX = '4'
    const MAX_LOSS = -1.75;
    const SLASH = '%2F';

    let auto_refresh = true;
    let chart_positions = null;
    let chart_bollinger = null;
    let chart_bollinger_1 = null;
    let chart_bollinger_2 = null;
    let chart_symbols_stacked_1 = null;
    let chart_symbols_stacked_2 = null;
    let chart_symbols_stacked_3 = null;
    let chart_symbols_stacked_4 = null;
    let chart_symbols_stacked_5 = null;
    let chart_symbols_stacked_6 = null;
    let chart_symbols_stacked_7 = null;
    let chart_symbols_stacked_8 = null;
    let chart_symbols_group_1 = null;
    let chart_symbols_group_2 = null;
    let chart_symbols_group_3 = null;
    let chart_symbols_group_4 = null;
    let chart_symbols_months = {};
    let chart_symbols_group_1_tree = null;
    let chart_symbols_group_2_tree = null;
    let chart_symbols_group_3_tree = null;
    let chart_symbols_group_4_tree = null;


    const isCrypto = localStorage.getItem('m3-trader-v5-crypto') === 'true' ? true : false;
    let selected_symbol = localStorage.getItem(`m3-trader-v5-selected-symbol`) || 'GE';

    // let selected_date = getTodayLocal();
    // let elem = document.getElementById('dateSelector');
    // elem.value = selected_date;
    // elem.max = selected_date;

    // =================================================\
    // ACTIVE TAB
    // =================================================
    let activeTab = localStorage.getItem('m3-trader-v5-activeTab') || 'weeks';
    function openTab(name) {
        var i;
        var x = document.getElementsByClassName("w3-bar-item");
        for (i = 0; i < x.length; i++) {
            x[i].style.borderBottom = '';
        }
        document.getElementById('btn-tab-' + name).style.borderBottom = '7px solid #00b90a';
        tabs.forEach((k, i) => {
            k = k.toLowerCase();
            document.getElementById(`content-${k}`).style.display = name === k ? 'block' : 'none';
        });
        activeTab = name;
        localStorage.setItem('m3-trader-v5-activeTab', name);
    }

    // =================================================
    // TOGGLE GROUPS
    // =================================================
    function toggle_groups(name) {
        ['stocks', 'favs', 'rd', 'crypto', 'account', 'table', 'info', 'symbols'].forEach((k) => {
            document.getElementById(`chart-bars`).style.display = (['account', 'table', 'info', /*'symbols'*/].includes(name) ? 'none' : '');
            const elem = document.getElementById(`symbol-buttons-bollinger-${k}`);
            elem.style.display = name === k ? 'block' : 'none';
            elem.checked = name === k ? true : false;
        });
    }

    // =================================================
    // CLICK DATE
    // =================================================
    function clickDate(date) {
        selected_date = date;
        document.getElementById('dateSelector').max = getTodayLocal(); // Set maxc date to today
        // clickSymbol(selected_symbol);
        update(true);
    }

    // =================================================
    // TOGGLE AUTO RESET
    // =================================================
    function toggleAutoReset(elem) {
        auto_refresh = !auto_refresh;
        if (auto_refresh) {
            elem.classList.remove('fa-toggle-off');
            elem.classList.add('fa-toggle-on');
            elem.style.color = '#00b90a';
        } else {
            elem.classList.remove('fa-toggle-on');
            elem.classList.add('fa-toggle-off');
            elem.style.color = '#f00';
        }
    }

    // =================================================
    // TOGGLE CRYPTO / STOCKS
    // =================================================
    function toggleCryptoStocks(elem, reload = true) {
        elem = document.getElementById('toggle-crypto');
        const on = elem.classList.value.indexOf('fa-toggle-on') >= 0;
        if (!on) {
            elem.classList.remove('fa-toggle-off');
            elem.classList.add('fa-toggle-on');
            elem.style.color = '#00b90a';
            // symbol_buttons = symbol_buttons_all.filter((v) => !v.endsWith('/USD'));
            localStorage.setItem('m3-trader-v5-crypto', true);
        } else {
            elem.classList.remove('fa-toggle-on');
            elem.classList.add('fa-toggle-off');
            elem.style.color = '#f00';
            // symbol_buttons = symbol_buttons_all.filter((v) => v.endsWith('/USD'));
            localStorage.setItem('m3-trader-v5-crypto', false);
            // clickSymbol(selected)
        }
        if (reload) {
            window.location = window.location;
        }
    }

    // =================================================
    // PROCESS CONFIGURATION
    // =================================================
    const tabs = ['Bollinger', 'Weeks'];
    function processConfiguration() {
        // /** create tab buttons and load the first page */
        let html_tabs = ``;
        tabs.forEach((k, i) => {
            if (k.indexOf('_') !== 0) {
                const tab = k.toLowerCase();
                const text = k;
                let style = 'border-right:0.5px solid #505050;min-width:100px;'
                style += i === 0 ? 'border-bottom:7px solid #007585;' : 'border-bottom:7px solid black';
                let html = `<button id="btn-tab-${tab}" class="w3-bar-item w3-button w3-hide-small w3-hide-medium" style="${style}"
                    onclick="openTab('${tab}')">${text}</button>`;
                html_tabs += html;
            }
        });
        // html_tabs += isMobile() ? '' : `<span class="w3-right" style="font-size:32px;margin:0px 24px 0px 0px;color: #00b90a;">
        //     <i class="fa fa-toggle-on" style="cursor:pointer;" onclick="toggleAutoReset(this)"></i>
        //     <span class="w3-medium" style="padding-right: 5px;top: -7px;display: inline;position: relative;">Auto Refresh </span>

        //     <i id="toggle-crypto" class="fa fa-toggle-on" style="cursor:pointer;" onclick="toggleCryptoStocks(this)"></i>
        //     <span class="w3-medium" style="padding-right: 5px;top: -7px;display: inline;position: relative;">Crypto </span>

        //     <i id="open-settings" class="fa fa-gear" style="cursor:pointer;" onclick="open_settings()"></i>
        //     <span class="w3-medium" style="padding-right: 5px;top: -7px;display: inline;position: relative;">Settings </span>

        //     </span>
        //     `;
        // html_tabs += `<hr/>`;
        document.getElementById('tabs').innerHTML += html_tabs;
        // if (!isCrypto) {
        //     toggleCryptoStocks(null, false);
        // }

        'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('').forEach((letter) => {
            let btn = document.createElement('button');
            btn.className = 'w3-button _w3-black w3-margin-bottom w3-margin-top w3-margin-right w3-round-large';
            btn.style.minWidth = '40px';
            btn.style.fontSize = isMobile() ? '18px' : '24px';
            btn.innerText = letter;
            btn.onclick = () => {
                // document.getElementById('letters').querySelectorAll('button').forEach((b) => {
                //     b.style.backgroundColor = '#000';
                // });
                // btn.style.backgroundColor = '#00b90a';
                // btn.style.color = 'yellow';
                const container = document.getElementById('symbol-buttons-bollinger-symbols');
                container.querySelectorAll('button').forEach((b) => {
                    if (b.innerText.startsWith(letter)) {
                        b.style.color = 'yellow';
                        b.style.fontWeight = '900';
                    } else {
                        b.style.color = '';
                        b.style.fontWeight = '';
                    }
                });
                document.getElementById('symbols_for_letter').innerHTML = '';
                const stock_symbols_for_letter = stock_symbols_detail
                    .filter((v) => v.symbol.startsWith(letter))
                    .filter((v) => v.tradable === true)
                    .filter((v) => v.fractionable === true)
                    // .map((v) => v.symbol)
                    .sort((a,b) => a.symbol.localeCompare(b.symbol))
                    .forEach((v) => {
                        let btn = document.createElement('button');
                        btn.className = 'w3-button _w3-black w3-margin-bottom w3-margin-top w3-margin-right w3-round-large';
                        btn.style.minWidth = '40px';
                        btn.style.fontSize = isMobile() ? '18px' : '24px';
                        btn.style.borderBottom = '1px solid #ffffff8a';
                        // btn.innerText = `${v.symbol}`;
                        btn.innerHTML = `<span class="w3-tooltip">${v.symbol} <span style="background-color:black;color:yellow;position:fixed;left:20px;bottom:18px" class="w3-text w3-tag">${v.name}</span></span>`;
                        btn.onclick = () => {
                            test4(v.symbol, true, true)
                        };
                        document.getElementById('symbols_for_letter').appendChild(btn);
                    });
                console.log('FILTER LETTER', letter, stock_symbols_for_letter);
            };
            document.getElementById('letters').appendChild(btn);
        });
    }
    function clickLetter(elem) {
        console.log('CLICK LETTER', elem);
        elem.style.color = 'yellow';
        // document.getElementById('letters').querySelectorAll('button').forEach((b) => {
        //     b.style.backgroundColor = '#000';
        // });
        // const btn = Array.from(document.getElementById('letters').querySelectorAll('button')).find((b) => b.innerText === letter);
        // if (btn) {
        //     btn.style.backgroundColor = '#00b90a';
        // }
        // const container = document.getElementById('symbol-buttons-bollinger-symbols');
        // container.querySelectorAll('button').forEach((b) => {
        //     if (b.innerText.startsWith(letter)) {
        //         b.style.display = 'inline-block';
        //     } else {
        //         b.style.display = 'none';
        //     }
        // });
    }

    // =================================================
    //                    STARTUP
    // =================================================
    processConfiguration();
    openTab(activeTab);
    toggle_groups('info');
    test4('PLTR');

    setInterval(async () => {
        const d = new Date();
        document.getElementById('datetime').innerHTML = isMobile() && !isTablet()
            ? ` (${d.getSeconds().toString().padStart(2, '0')})`
            : d.toLocaleTimeString().split(' ')[0];
        if (d.getMinutes() === 59 && d.getSeconds() === 59) {
            console.clear();
        }
    }, 1 * 1000);

    // =================================================
    //              LOCAL STORAGE SIZE
    // =================================================
    function getLocalStorageSize() {
        let totalSize = 0;
        for (let key in localStorage) {
            if (localStorage.hasOwnProperty(key)) {
                let value = localStorage.getItem(key);
                totalSize += value.length * 2;
            }
        }
        return totalSize; // Size in bytes
    }

    const sizeInBytes = getLocalStorageSize();
    const sizeInKB = sizeInBytes / 1024;
    const sizeInMB = sizeInKB / 1024;

    console.group('Local Storage');
    console.info(`Size in bytes: ${sizeInBytes.toLocaleString()}`);
    console.info(`Size in KB: ${round3(sizeInKB)}`);
    console.info(`Size in MB: ${round4(sizeInMB)}`);
    console.groupEnd();

    console.group('Memory Usage');
    if (performance.memory) {
        console.log('Used JS heap:', (performance.memory.usedJSHeapSize).toLocaleString());
        console.log('Total JS heap:', (performance.memory.totalJSHeapSize).toLocaleString());
        console.log('JS heap limit:', (performance.memory.jsHeapSizeLimit).toLocaleString());
    } else {
        console.log('performance.memory API is not available in this browser.');
    }
    console.groupEnd();

    const days_ytd = Math.floor((new Date(getDateString(getTodayLocal()).e).getTime() - new Date(START_OF_YEAR).getTime()) / (24 * 60 * 60 * 1000));
    console.info(`Days YTD: ${days_ytd}`);

    function toggleDarkMode() {
        let x = document.body;
        x.classList.toggle("w3-black");
    }
</script>

</html>